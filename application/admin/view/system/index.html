<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
            <title>
            </title>
            <link href="/layuiadmin/layui/css/layui.css" media="all" rel="stylesheet">
                <link href="/layuiadmin/style/admin.css" media="all" rel="stylesheet">
                </link>
            </link>
        </meta>
        <style type="text/css">
            .layui-form-item{
                width: 80%;
            }
        </style>
    </head>
    <body>

        <form action="" class="layui-form" lay-filter="admininfo" style="padding-right: 20px;padding-left: 20px;">
            <div class="layui-form" style="width: 50%;">
                <table class="layui-table">
                    <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                    </colgroup>
                    <thead>
                        <tr>
                            <th>{:lang('Configname')}</th>
                            <th>{:lang('Configparam')}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {foreach $config as $item}
                        <tr>
                            <td>
                                {$item.decs}
                            </td>
                            <td>
                                <input type="{$item.type}" name="{$item.config_name}" value="{$item.config_value}" lay-verify="{$item.verify}" placeholder="{$item.decs}" class="layui-input">
                            </td>
                        </tr>
                        {/foreach}
                    </tbody>
                </table>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block" style="margin-left:0;">
                    <button class="layui-btn" lay-filter="subconfig" lay-submit="" type="submit">
                        {:lang('Submit')}
                    </button>
                </div>
            </div>
        </form>
        <script src="/layuiadmin/layui/layui.js"></script>
        <script>
            layui.use(['jquery','form', 'layedit'], function(){
                var form = layui.form
                ,layer = layui.layer
                var $ = layui.jquery;

                //自定义验证规则
                days = /^[1-9]\d*$/;
                form.verify({
                    days: function(value){
                        var flag = days.test(value)
                        if(!flag){
                            return '{:lang("CustomerToPoolTimeTips")}';
                        }
                    }
                });

                //监听提交
                form.on('submit(subconfig)', function(data){
                    var postData = data.field;
                    $.post({
                        url:"{:url('system/index')}",
                        type:'post',
                        // sync:true,
                        data:postData,
                        
                        error:function(data){
                            console.log(data)
                        },
                        success:function(data){
                            layer.alert(data.msg, {
                              title: '{:lang("Tips")}'
                              ,btn:['{:lang("IMSure")}']
                            })
                            if(data.code==0){
                                location.reload();
                            }
                        },
                        complete: function () {
                            // layer.close(this.layerIndex);
                        },
                    });
                    // console.log(postData)
                    return false;
                });
            });
        </script>
    </body>
</html>